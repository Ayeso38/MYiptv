<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio Player - StreamView</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.4.12/hls.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
    <!-- Header -->
    <div class="bg-black/30 backdrop-blur-md border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                        <line x1="8" y1="21" x2="16" y2="21"></line>
                        <line x1="12" y1="17" x2="12" y2="21"></line>
                    </svg>
                    <h1 class="text-2xl font-bold text-white">StreamView</h1>
                </div>
                <nav class="flex items-center gap-2">
                    <a href="index.html" class="px-4 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm font-medium">
                        <div class="flex items-center gap-2">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21"></line>
                                <line x1="12" y1="17" x2="12" y2="21"></line>
                            </svg>
                            <span class="hidden sm:inline">Stream</span>
                        </div>
                    </a>
                    <a href="video.html" class="px-4 py-2 text-white/80 hover:text-white hover:bg-white/10 rounded-lg transition-all text-sm font-medium">
                        <div class="flex items-center gap-2">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect>
                                <line x1="7" y1="2" x2="7" y2="22"></line>
                                <line x1="17" y1="2" x2="17" y2="22"></line>
                                <line x1="2" y1="12" x2="22" y2="12"></line>
                                <line x1="2" y1="7" x2="7" y2="7"></line>
                                <line x1="2" y1="17" x2="7" y2="17"></line>
                                <line x1="17" y1="17" x2="22" y2="17"></line>
                                <line x1="17" y1="7" x2="22" y2="7"></line>
                            </svg>
                            <span class="hidden sm:inline">Video</span>
                        </div>
                    </a>
                    <a href="radio.html" class="px-4 py-2 bg-purple-600 text-white rounded-lg transition-all text-sm font-medium hover:bg-purple-700">
                        <div class="flex items-center gap-2">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                <circle cx="12" cy="12" r="2"></circle>
                                <path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path>
                            </svg>
                            <span class="hidden sm:inline">Radio</span>
                        </div>
                    </a>
                </nav>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-3xl mx-auto px-4 py-8">
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-8 border border-white/20 shadow-2xl">
            <h2 class="text-white text-2xl font-bold mb-2 text-center">ðŸ“» Radio Player</h2>
            <p class="text-gray-400 text-center text-sm mb-8">Stream your favorite radio stations</p>
            
            <!-- Radio Display -->
            <div class="bg-gradient-to-br from-purple-600/20 to-pink-600/20 rounded-2xl p-8 text-center mb-6 border-2 border-purple-500/30">
                <div id="radioIcon" class="text-7xl mb-4">ðŸ“»</div>
                <div id="stationName" class="text-white text-2xl font-bold mb-2">Ready to Play</div>
                <div id="nowPlaying" class="text-gray-300 text-sm mb-4">Enter a stream URL to start</div>
                
                <!-- Visualizer -->
                <div id="visualizer" class="flex gap-1 justify-center items-end h-12">
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                    <div class="w-1 bg-purple-500 rounded-t transition-all duration-100" style="height: 8px;"></div>
                </div>
            </div>

            <!-- URL Input -->
            <div class="mb-6">
                <label class="block text-purple-400 font-semibold mb-3 text-sm">Stream URL (M3U8)</label>
                <input 
                    type="text" 
                    id="streamUrl" 
                    placeholder="https://example.com/stream/index.m3u8"
                    class="w-full px-4 py-3 bg-black/30 border-2 border-white/20 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"
                >
            </div>

            <!-- Controls -->
            <div class="space-y-3 mb-6">
                <button id="loadBtn" class="w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all shadow-lg flex items-center justify-center gap-2">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Load Stream
                </button>

                <div class="flex gap-3">
                    <button id="playPauseBtn" disabled class="flex-1 px-6 py-3 bg-purple-600 text-white font-semibold rounded-xl hover:bg-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                        Play
                    </button>
                    <button id="stopBtn" disabled class="flex-1 px-6 py-3 bg-white/10 text-white font-semibold rounded-xl hover:bg-white/20 transition-all border border-white/20 disabled:opacity-50 disabled:cursor-not-allowed">
                        Stop
                    </button>
                </div>
            </div>

            <!-- Volume Control -->
            <div class="flex items-center gap-3 p-4 bg-black/30 rounded-xl mb-4">
                <span class="text-xl">ðŸ”Š</span>
                <input type="range" id="volumeControl" min="0" max="100" value="70" class="flex-1">
                <span id="volumeValue" class="text-purple-400 font-semibold min-w-[45px] text-right">70%</span>
            </div>

            <!-- Loading -->
            <div id="loading" class="items-center justify-center gap-3 text-white mb-4" style="display: none;">
                <svg class="animate-spin" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
                </svg>
                <span>Loading stream...</span>
            </div>

            <!-- Status -->
            <div id="status" class="text-center text-purple-400 font-medium py-3 bg-purple-500/10 rounded-xl border border-purple-500/20">
                Ready
            </div>

            <!-- Error -->
            <div id="errorMessage" class="mt-4 text-red-300 bg-red-500/20 border border-red-500/50 rounded-xl p-4 text-center text-sm" style="display: none;"></div>

            <audio id="audioPlayer"></audio>
        </div>

        <!-- Info Section -->
        <div class="mt-6 bg-white/5 backdrop-blur-lg rounded-2xl p-6 border border-white/10">
            <h3 class="text-white font-semibold mb-3">How to Use</h3>
            <ul class="text-gray-300 space-y-2 text-sm">
                <li>â€¢ Paste your M3U8 radio stream URL in the input field</li>
                <li>â€¢ Click "Load Stream" or press Enter</li>
                <li>â€¢ Once loaded, click "Play" to start listening</li>
                <li>â€¢ Adjust volume with the slider</li>
                <li>â€¢ Use "Stop" to completely reset the stream</li>
            </ul>
        </div>
    </div>

    <script>
        const audio = document.getElementById('audioPlayer');
        const streamUrlInput = document.getElementById('streamUrl');
        const loadBtn = document.getElementById('loadBtn');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        const volumeControl = document.getElementById('volumeControl');
        const volumeValue = document.getElementById('volumeValue');
        const statusEl = document.getElementById('status');
        const loadingEl = document.getElementById('loading');
        const errorEl = document.getElementById('errorMessage');
        const radioIcon = document.getElementById('radioIcon');
        const stationName = document.getElementById('stationName');
        const nowPlaying = document.getElementById('nowPlaying');
        const visualizer = document.getElementById('visualizer');
        
        let hls;
        let isPlaying = false;
        let visualizerInterval;

        function showLoading(show) {
            loadingEl.style.display = show ? 'flex' : 'none';
        }

        function showError(message) {
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            setTimeout(() => {
                errorEl.style.display = 'none';
            }, 5000);
        }

        function updateStatus(message) {
            statusEl.textContent = message;
        }

        function updateDisplay(name, playing) {
            stationName.textContent = name;
            nowPlaying.textContent = playing;
            radioIcon.textContent = isPlaying ? 'ðŸŽµ' : 'ðŸ“»';
        }

        function animateVisualizer() {
            const bars = visualizer.querySelectorAll('div');
            if (isPlaying) {
                bars.forEach(bar => {
                    const height = Math.random() * 40 + 10;
                    bar.style.height = height + 'px';
                });
            } else {
                bars.forEach(bar => {
                    bar.style.height = '8px';
                });
            }
        }

        function startVisualizer() {
            visualizerInterval = setInterval(animateVisualizer, 150);
        }

        function stopVisualizer() {
            if (visualizerInterval) {
                clearInterval(visualizerInterval);
                animateVisualizer();
            }
        }

        function loadStream() {
            const url = streamUrlInput.value.trim();
            
            if (!url) {
                showError('Please enter a stream URL');
                return;
            }

            showLoading(true);
            updateStatus('Loading...');
            errorEl.style.display = 'none';

            if (hls) {
                hls.destroy();
            }

            if (Hls.isSupported()) {
                hls = new Hls({
                    enableWorker: true,
                    lowLatencyMode: true,
                    backBufferLength: 90
                });

                hls.loadSource(url);
                hls.attachMedia(audio);

                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    showLoading(false);
                    updateStatus('Stream Loaded');
                    playPauseBtn.disabled = false;
                    stopBtn.disabled = false;
                    
                    try {
                        const stationUrl = new URL(url);
                        updateDisplay('Radio Station', stationUrl.hostname);
                    } catch (e) {
                        updateDisplay('Radio Station', 'Stream Ready');
                    }
                });

                hls.on(Hls.Events.ERROR, (event, data) => {
                    if (data.fatal) {
                        showLoading(false);
                        switch(data.type) {
                            case Hls.ErrorTypes.NETWORK_ERROR:
                                showError('Network error - check the URL or try again');
                                updateStatus('Network Error');
                                break;
                            case Hls.ErrorTypes.MEDIA_ERROR:
                                showError('Media error - invalid stream format');
                                updateStatus('Media Error');
                                break;
                            default:
                                showError('Failed to load stream');
                                updateStatus('Error');
                                break;
                        }
                    }
                });

            } else if (audio.canPlayType('application/vnd.apple.mpegurl')) {
                audio.src = url;
                audio.addEventListener('loadedmetadata', () => {
                    showLoading(false);
                    updateStatus('Stream Loaded');
                    playPauseBtn.disabled = false;
                    stopBtn.disabled = false;
                    
                    try {
                        const stationUrl = new URL(url);
                        updateDisplay('Radio Station', stationUrl.hostname);
                    } catch (e) {
                        updateDisplay('Radio Station', 'Stream Ready');
                    }
                }, { once: true });
            } else {
                showLoading(false);
                showError('HLS is not supported in this browser');
                updateStatus('Not Supported');
            }
        }

        loadBtn.addEventListener('click', loadStream);

        streamUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                loadStream();
            }
        });

        playPauseBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play();
            } else {
                audio.pause();
            }
        });

        stopBtn.addEventListener('click', () => {
            audio.pause();
            audio.currentTime = 0;
            if (hls) {
                hls.destroy();
                hls = null;
            }
            playPauseBtn.disabled = true;
            stopBtn.disabled = true;
            isPlaying = false;
            stopVisualizer();
            updateStatus('Stopped');
            updateDisplay('Ready to Play', 'Enter a stream URL to start');
        });

        audio.addEventListener('play', () => {
            isPlaying = true;
            playPauseBtn.textContent = 'Pause';
            updateStatus('Playing');
            startVisualizer();
            updateDisplay('Now Playing', 'Live Stream');
        });

        audio.addEventListener('pause', () => {
            isPlaying = false;
            playPauseBtn.textContent = 'Play';
            updateStatus('Paused');
            stopVisualizer();
        });

        audio.addEventListener('waiting', () => {
            updateStatus('Buffering...');
        });

        audio.addEventListener('canplay', () => {
            if (isPlaying) {
                updateStatus('Playing');
            }
        });

        volumeControl.addEventListener('input', (e) => {
            const value = e.target.value;
            audio.volume = value / 100;
            volumeValue.textContent = value + '%';
        });

        audio.volume = 0.7;
        startVisualizer();
    </script>
</body>
</html>
